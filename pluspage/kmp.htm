<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 10">
<meta name=Originator content="Microsoft Word 10">
<link rel=File-List href="kmp.files/filelist.xml">
<link rel=Edit-Time-Data href="kmp.files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>模式匹配的一种改进算法----KMP算法</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>李康</o:Author>
  <o:LastAuthor>李康</o:LastAuthor>
  <o:Revision>1</o:Revision>
  <o:TotalTime>4</o:TotalTime>
  <o:Created>2005-06-24T11:36:00Z</o:Created>
  <o:LastSaved>2005-06-24T11:40:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>755</o:Words>
  <o:Characters>4310</o:Characters>
  <o:Company>西北大学可视化技术研究所</o:Company>
  <o:Lines>35</o:Lines>
  <o:Paragraphs>10</o:Paragraphs>
  <o:CharactersWithSpaces>5055</o:CharactersWithSpaces>
  <o:Version>10.2625</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:GrammarState>Clean</w:GrammarState>
  <w:PunctuationKerning/>
  <w:DrawingGridVerticalSpacing>7.8 磅</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:黑体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimHei;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:楷体_utf-8;
	panose-1:2 1 6 9 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@楷体_utf-8";
	panose-1:2 1 6 9 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:"\@黑体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-update:auto;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:10.0pt;
	mso-char-indent-count:2.0;
	mso-pagination:none;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:楷体_utf-8;
	mso-font-kerning:1.0pt;}
h2
	{mso-style-next:正文;
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:18.0pt;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:2;
	mso-layout-grid-align:none;
	font-size:15.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:黑体;
	mso-hansi-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:15.0pt;
	font-weight:normal;}
p.MsoNormalIndent, li.MsoNormalIndent, div.MsoNormalIndent
	{mso-style-name:"正文缩进\,表格";
	mso-style-update:auto;
	mso-style-next:正文;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:12.0pt;
	mso-line-height-rule:exactly;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:楷体_utf-8;
	mso-font-kerning:1.0pt;}
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:21.0pt;
	mso-para-margin-top:0cm;
	mso-para-margin-right:0cm;
	mso-para-margin-bottom:6.0pt;
	mso-para-margin-left:2.0gd;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:10.0pt;
	mso-char-indent-count:2.0;
	mso-pagination:none;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:楷体_utf-8;
	mso-font-kerning:1.0pt;}
p.MsoBodyTextFirstIndent2, li.MsoBodyTextFirstIndent2, div.MsoBodyTextFirstIndent2
	{mso-style-parent:正文文本缩进;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:21.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:10.5pt;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:10.0pt;
	mso-char-indent-count:2.0;
	mso-pagination:none;
	font-size:10.5pt;
	font-family:宋体;
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	mso-font-kerning:1.0pt;}
p.a, li.a, div.a
	{mso-style-name:图题;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:宋体;
	mso-hansi-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:1.0pt;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;
	layout-grid:15.6pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:-132;
	mso-list-type:simple;
	mso-list-template-ids:471639122;}
@list l0:level1
	{mso-level-tab-stop:102.0pt;
	mso-level-number-position:left;
	margin-left:102.0pt;
	mso-para-margin-left:8.0gd;
	text-indent:-18.0pt;
	mso-char-indent-count:-2.0;}
@list l1
	{mso-list-id:-131;
	mso-list-type:simple;
	mso-list-template-ids:552747110;}
@list l1:level1
	{mso-level-tab-stop:81.0pt;
	mso-level-number-position:left;
	margin-left:81.0pt;
	mso-para-margin-left:6.0gd;
	text-indent:-18.0pt;
	mso-char-indent-count:-2.0;}
@list l2
	{mso-list-id:-130;
	mso-list-type:simple;
	mso-list-template-ids:-360178406;}
@list l2:level1
	{mso-level-tab-stop:60.0pt;
	mso-level-number-position:left;
	margin-left:60.0pt;
	mso-para-margin-left:4.0gd;
	text-indent:-18.0pt;
	mso-char-indent-count:-2.0;}
@list l3
	{mso-list-id:-129;
	mso-list-type:simple;
	mso-list-template-ids:-401829596;}
@list l3:level1
	{mso-level-tab-stop:39.0pt;
	mso-level-number-position:left;
	margin-left:39.0pt;
	mso-para-margin-left:2.0gd;
	text-indent:-18.0pt;
	mso-char-indent-count:-2.0;}
@list l4
	{mso-list-id:-128;
	mso-list-type:simple;
	mso-list-template-ids:1514199224;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:102.0pt;
	mso-level-number-position:left;
	margin-left:102.0pt;
	mso-para-margin-left:8.0gd;
	text-indent:-18.0pt;
	mso-char-indent-count:-2.0;
	font-family:Wingdings;}
@list l5
	{mso-list-id:-127;
	mso-list-type:simple;
	mso-list-template-ids:681096240;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:81.0pt;
	mso-level-number-position:left;
	margin-left:81.0pt;
	mso-para-margin-left:6.0gd;
	text-indent:-18.0pt;
	mso-char-indent-count:-2.0;
	font-family:Wingdings;}
@list l6
	{mso-list-id:-126;
	mso-list-type:simple;
	mso-list-template-ids:-164852410;}
@list l6:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:60.0pt;
	mso-level-number-position:left;
	margin-left:60.0pt;
	mso-para-margin-left:4.0gd;
	text-indent:-18.0pt;
	mso-char-indent-count:-2.0;
	font-family:Wingdings;}
@list l7
	{mso-list-id:-125;
	mso-list-type:simple;
	mso-list-template-ids:719633670;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:39.0pt;
	mso-level-number-position:left;
	margin-left:39.0pt;
	mso-para-margin-left:2.0gd;
	text-indent:-18.0pt;
	mso-char-indent-count:-2.0;
	font-family:Wingdings;}
@list l8
	{mso-list-id:-120;
	mso-list-type:simple;
	mso-list-template-ids:1067629086;}
@list l8:level1
	{mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;
	mso-char-indent-count:-2.0;}
@list l9
	{mso-list-id:-119;
	mso-list-type:simple;
	mso-list-template-ids:132691376;}
@list l9:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;
	mso-char-indent-count:-2.0;
	font-family:Wingdings;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:普通表格;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=ZH-CN style='tab-interval:21.0pt;text-justify-trim:punctuation'>

<div class=Section1 style='layout-grid:15.6pt'>

<h2><b><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>模式匹配的一种改进算法</span></b><b><span
lang=EN-US style='font-family:"Times New Roman";mso-fareast-font-family:宋体'>----KMP</span></b><b><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>算法</span></b><b><span lang=EN-US style='font-family:"Times New Roman";
mso-fareast-font-family:宋体'><o:p></o:p></span></b></h2>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>这种改进算法是<span lang=EN-US>D.E.Knuth与V.R.Pratt和J.H.Morris同时发现的，因此人们称它为<span
class=GramE>克努特</span>-莫里斯-普拉<span class=GramE>特</span>算法（简称为KMP算法）。该算法可以在O(<i
style='mso-bidi-font-style:normal'>n</i>+<i style='mso-bidi-font-style:normal'>m</i>)的时间数量级上完成串的模式匹配操作。其改进在于：每当一趟匹配过程中出现字符比较不等时，不需回溯i指针，而是利用已经得到的&ldquo;部分匹配&rdquo;的结果<span
class=GramE>将模式</span>向右&ldquo;滑动&rdquo;尽可能远的一段距离后，继续进行比较。
      <o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体;color:black'>回顾例<span lang=EN-US>4.1，见图4.1的匹配过程示例，在第三趟的匹配中，当</span></span><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>i</span></i><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>=6<span
style='color:black'>、</span><i style='mso-bidi-font-style:normal'>j</i>=4<span
style='color:black'>字符比较不等时，又从</span><i style='mso-bidi-font-style:normal'>i=3</i>、<i
style='mso-bidi-font-style:normal'>j=0</i>重新开始比较。然后，经过仔细观察可发现，在<i
style='mso-bidi-font-style:normal'>i</i>=3和<i style='mso-bidi-font-style:normal'>j</i>=0，<i
style='mso-bidi-font-style:normal'>i</i>=4和<i style='mso-bidi-font-style:normal'>j</i>=0以及<i
style='mso-bidi-font-style:normal'>i</i>=5和<i style='mso-bidi-font-style:normal'>j=0</i>这三次比较都是不必进行的。因为从第三趟部分匹配的结果就可得出，<span
class=GramE>主串中</span>第4、5、6个字符必然是b、c、a，（即模式串中第2、3和4个字符）。因为模式中的第一个字符是a，因此它无需再和这三个字符进行比较，而仅需<span
class=GramE>将模式</span>向右滑动三个字符的位置继续进行<i style='mso-bidi-font-style:normal'>i</i>=6、<i
style='mso-bidi-font-style:normal'>j</i>=1时的字符比较即可。同理，在第一匹配中出现字符不等时，仅需<span
class=GramE>将模式</span>向右移动两个字符的位置进行<i style='mso-bidi-font-style:normal'>i</i>=2、<i
style='mso-bidi-font-style:normal'>j</i>=0时的字符比较。因此，在整个匹配的过程中，i指针没<span
style='color:black'>有回溯，如图f-1所示。<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><img src="kmp.files/f-1.jpg" width="445" height="315"><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体;color:black'>一般情况下，假设<span
class=GramE>主串为</span><i style='mso-bidi-font-style:normal'><span lang=EN-US>s</span></i></span><i
style='mso-bidi-font-style:normal'><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体;color:black'>0</span></sub></i><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体;color:black'>s</span></i><i style='mso-bidi-font-style:normal'><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体;color:black'>1</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体;color:black'>…s</span></i><i
style='mso-bidi-font-style:normal'><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体;color:black'>n-1</span></sub></i><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体;color:black'>，<span class=GramE>模式串为</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>p</span></i></span><i
style='mso-bidi-font-style:normal'><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体;color:black'>0</span></sub></i><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体;color:black'>p</span></i><i style='mso-bidi-font-style:normal'><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体;color:black'>1</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体;color:black'>…p</span></i><i
style='mso-bidi-font-style:normal'><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体;color:black'>m-1</span></sub></i><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体;color:black'>，从上例的分析可知，为了实现</span><span
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>改进算法，需要解决下述问题：当匹配过程中产生“失配”（即<i
style='mso-bidi-font-style:normal'><span lang=EN-US>s</span></i></span><i
style='mso-bidi-font-style:normal'><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>i</span></sub></i><i style='mso-bidi-font-style:normal'><span
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>≠<span
lang=EN-US>p</span></span></i><i style='mso-bidi-font-style:normal'><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><span
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>）时，模式串“向右滑动”可行的距离有多远，换句话说，当<span
class=GramE>主串中</span>字符<i style='mso-bidi-font-style:normal'><span lang=EN-US>S<sub>i</sub></span></i>与模式中字符<i
style='mso-bidi-font-style:normal'><span lang=EN-US>P<sub>j</sub></span></i><span
lang=EN-US> “失配”（即比较不等）时，<span class=GramE>主串中</span>字符<i style='mso-bidi-font-style:
normal'>S<sub>i</sub></i>（<i style='mso-bidi-font-style:normal'>i</i>指针不回溯）应与模式中哪个字符再比较？<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>假设此时<span class=GramE>主串中</span>字符<span
lang=EN-US>S<sub>i</sub>应与模式中字符<i style='mso-bidi-font-style:normal'>P<sub>k</sub></i>（k＜j）继续比较，<span
class=GramE>则模式</span>中字符<i style='mso-bidi-font-style:normal'>P<sub>k</sub></i>前面<i
style='mso-bidi-font-style:normal'>k</i><span class=GramE>个</span>字符的<span
class=GramE>子串必须</span>满足下列关系式（f-1），且不存在<i style='mso-bidi-font-style:normal'>k'</i>＞<i
style='mso-bidi-font-style:normal'>k</i>满足下列关系式<span class=GramE>（</span>f-1）<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><i style='mso-bidi-font-style:
normal'><span lang=FR style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体;mso-ansi-language:FR'>p</span></i><sub><span lang=FR
style='font-size:10.5pt;font-family:宋体;mso-ansi-language:FR'>0</span></sub><i
style='mso-bidi-font-style:normal'><span lang=FR style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体;mso-ansi-language:FR'>p</span></i><sub><span
lang=FR style='font-size:10.5pt;font-family:宋体;mso-ansi-language:FR'>1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=FR style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体;mso-ansi-language:FR'>…p</span></i><i
style='mso-bidi-font-style:normal'><sub><span lang=FR style='font-size:10.5pt;
font-family:宋体;mso-ansi-language:FR'>k-</span></sub></i><sub><span lang=FR
style='font-size:10.5pt;font-family:宋体;mso-ansi-language:FR'>1<i
style='mso-bidi-font-style:normal'> </i></span></sub><span lang=FR
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ansi-language:
FR'>= <i style='mso-bidi-font-style:normal'>s</i></span><i style='mso-bidi-font-style:
normal'><sub><span lang=FR style='font-size:10.5pt;font-family:宋体;mso-ansi-language:
FR'>i-k</span></sub></i><i style='mso-bidi-font-style:normal'><span lang=FR
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ansi-language:
FR'>s</span></i><i style='mso-bidi-font-style:normal'><sub><span lang=FR
style='font-size:10.5pt;font-family:宋体;mso-ansi-language:FR'>i-k+</span></sub></i><sub><span
lang=FR style='font-size:10.5pt;font-family:宋体;mso-ansi-language:FR'>1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=FR style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体;mso-ansi-language:FR'>…s</span></i><i
style='mso-bidi-font-style:normal'><sub><span lang=FR style='font-size:10.5pt;
font-family:宋体;mso-ansi-language:FR'>i-</span></sub></i><sub><span lang=FR
style='font-size:10.5pt;font-family:宋体;mso-ansi-language:FR'>1</span></sub><span
lang=FR style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ansi-language:FR'> <span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;</span>(f-1)<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>如图<span lang=EN-US>f-2所示。<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><o:p><img src="kmp.files/f-2.jpg" width="603" height="141"></o:p></span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>当<span class=GramE>主串中</span>字符<span
lang=EN-US>S<sub>i</sub>与模式中字符P<sub>j</sub> “失配”时，已经得到的“部分”匹配结果是：<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><i style='mso-bidi-font-style:
normal'><span lang=FR style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体;mso-ansi-language:FR'>p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=FR style='font-size:10.5pt;font-family:宋体;mso-ansi-language:
FR'>j</span></sub></i><sub><span lang=FR style='font-size:10.5pt;font-family:
宋体;mso-ansi-language:FR'>-<i style='mso-bidi-font-style:normal'>k</i></span></sub><i
style='mso-bidi-font-style:normal'><span lang=FR style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体;mso-ansi-language:FR'>p</span></i><i
style='mso-bidi-font-style:normal'><sub><span lang=FR style='font-size:10.5pt;
font-family:宋体;mso-ansi-language:FR'>j</span></sub></i><sub><span lang=FR
style='font-size:10.5pt;font-family:宋体;mso-ansi-language:FR'>-<i
style='mso-bidi-font-style:normal'>k</i>+1</span></sub><i style='mso-bidi-font-style:
normal'><span lang=FR style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体;mso-ansi-language:FR'>…p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=FR style='font-size:10.5pt;font-family:宋体;mso-ansi-language:
FR'>j-</span></sub></i><sub><span lang=FR style='font-size:10.5pt;font-family:
宋体;mso-ansi-language:FR'>1<i style='mso-bidi-font-style:normal'> </i></span></sub><span
lang=FR style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ansi-language:FR'>= <i style='mso-bidi-font-style:normal'>s</i></span><i
style='mso-bidi-font-style:normal'><sub><span lang=FR style='font-size:10.5pt;
font-family:宋体;mso-ansi-language:FR'>i-k</span></sub></i><i style='mso-bidi-font-style:
normal'><span lang=FR style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体;mso-ansi-language:FR'>s</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=FR style='font-size:10.5pt;font-family:宋体;mso-ansi-language:
FR'>i-k+</span></sub></i><sub><span lang=FR style='font-size:10.5pt;font-family:
宋体;mso-ansi-language:FR'>1</span></sub><i style='mso-bidi-font-style:normal'><span
lang=FR style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ansi-language:FR'>…s</span></i><i style='mso-bidi-font-style:normal'><sub><span
lang=FR style='font-size:10.5pt;font-family:宋体;mso-ansi-language:FR'>i-</span></sub></i><sub><span
lang=FR style='font-size:10.5pt;font-family:宋体;mso-ansi-language:FR'>1</span></sub><span
lang=FR style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ansi-language:FR'><span style='mso-spacerun:yes'>&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;</span>(f-2)<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>如图<span lang=EN-US>f-3所示。<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体;color:red'><o:p><img src="kmp.files/f-3.jpg" width="604" height="140"></o:p></span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>由（<span lang=EN-US>f-1）和（f-2）推得下列等式<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体'>p</span></i><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>0</span></sub><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>k</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-1</span></sub><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'> =
<i style='mso-bidi-font-style:normal'>p</i></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j-k</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j-k</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>+1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-1</span></sub><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;</span>(f-3)<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>我们称<span lang=EN-US>&quot;<i
style='mso-bidi-font-style:normal'>p</i></span></span><sub><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'>0</span></sub><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体'>p</span></i><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>1</span></sub><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>…p</span></i><i
style='mso-bidi-font-style:normal'><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>k</span></sub></i><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>-1</span></sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>&quot;为&quot;</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>0</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><sub><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'>1</span></sub><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体'>p</span></i><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>2</span></sub><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>…<i style='mso-bidi-font-style:normal'>p</i></span><i
style='mso-bidi-font-style:normal'><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>j</span></sub></i><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>-2</span></sub><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><i
style='mso-bidi-font-style:normal'><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>j</span></sub></i><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>-1</span></sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>&quot;的<span class=GramE>前缀子串</span>，&quot;</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j-k</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j-k</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>+1</span></sub><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>…<i
style='mso-bidi-font-style:normal'>p</i></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-1</span></sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>&quot;为&quot;</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><sub><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'>0</span></sub><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体'>p</span></i><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>1</span></sub><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>2</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-2</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-1</span></sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>&quot;的<span class=GramE>后缀子串</span>。</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span class=GramE><span
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>若模式串中</span></span><span
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>存在<span
class=GramE>真子串</span><i style='mso-bidi-font-style:normal'><span lang=EN-US>&quot;p</span></i></span><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>0</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><sub><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'>1</span></sub><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:normal'><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>k</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'> </span></i><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>=<i
style='mso-bidi-font-style:normal'> p</i></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j-k</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j-k</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>+1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>&quot;</span></i><span
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>，且满足<span
lang=EN-US>0&lt;<i style='mso-bidi-font-style:normal'>k</i>&lt;<i
style='mso-bidi-font-style:normal'>j</i>,则当匹配过程中，<span class=GramE>主串中</span>字符<i
style='mso-bidi-font-style:normal'>S<sub>i</sub></i>与模式中字符<i style='mso-bidi-font-style:
normal'>P<sub>j</sub></i>比较不等时，仅需<span class=GramE>将模式</span>向右滑动<span
class=GramE>至模式</span>中第<i style='mso-bidi-font-style:normal'>k</i><span
class=GramE>个</span>字符和<span class=GramE>主串中</span>字符<i style='mso-bidi-font-style:
normal'>S<sub>i</sub></i>对齐，此时，模式中头<i style='mso-bidi-font-style:normal'>k</i><span
class=GramE>个</span>字符<span class=GramE>的子串</span>&quot;<i style='mso-bidi-font-style:
normal'>p</i></span></span><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>0</span></sub><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>k</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-1</span></sub><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>&quot;必定与<span
class=GramE>主串中</span>字符<i style='mso-bidi-font-style:normal'>S<sub>i</sub></i>之前长度为<i
style='mso-bidi-font-style:normal'>k</i><span class=GramE>的子串</span>&quot;<i
style='mso-bidi-font-style:normal'>s</i></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>i-k</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>s</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>i-k</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>+1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>…s</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>i</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-1</span></sub><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>&quot;相等。由此，匹配仅需从模式中<i
style='mso-bidi-font-style:normal'>P<sub>k</sub></i>与<span class=GramE>主串中</span>字符<i
style='mso-bidi-font-style:normal'>S<sub>i</sub></i>比较起继续进行。<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>若令<i style='mso-bidi-font-style:normal'><span
lang=EN-US>next</span></i><span lang=EN-US>[<i style='mso-bidi-font-style:normal'>j</i>]=<i
style='mso-bidi-font-style:normal'>k</i>,则<i style='mso-bidi-font-style:normal'>next</i>[<i
style='mso-bidi-font-style:normal'>j</i>]表明<span class=GramE>当模式</span>中第<i
style='mso-bidi-font-style:normal'>j</i><span class=GramE>个</span>字符与<span
class=GramE>主串中</span>相应字符“失配”时，在模式中需重新和<span class=GramE>主串中</span>该字符进行比较的字符的位置。由此可引出模式串的next函数的定义：<o:p></o:p></span></span></p>

<img src="kmp.files/f-4.jpg" width="518" height="110">
<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>其中<i style='mso-bidi-font-style:normal'><span
lang=EN-US>p</span></i></span><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>0</span></sub><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>k</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-1</span></sub><span
style='font-size:10.5pt;font-family:宋体'>为</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体'>p</span></i><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>0</span></sub><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><sub><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'>2</span></sub><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:normal'><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-2</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-1</span></sub><span
style='font-size:10.5pt;font-family:宋体'>的<span class=GramE>前缀子串</span>，</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j-k</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j-k</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>+1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-1</span></sub><span
style='font-size:10.5pt;font-family:宋体'>为</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体'>p</span></i><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>0</span></sub><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><sub><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'>2</span></sub><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:normal'><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-2</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-1</span></sub><span
style='font-size:10.5pt;font-family:宋体'>的<span class=GramE>后缀子串</span>。<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:0cm;mso-char-indent-count:
0'><b><span style='font-size:10.5pt;font-family:宋体'>例<span lang=EN-US>1 </span></span></b><span
style='font-size:10.5pt;font-family:宋体'>计算例<span lang=EN-US>4.1中的模式串<i
style='mso-bidi-font-style:normal'>T</i>=</span></span><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体'>&quot;abcac&quot;</span></i><span style='font-size:10.5pt;
font-family:宋体'>的<span lang=EN-US>next函数值：<o:p></o:p></span></span></p>

<img src="kmp.files/f-5.jpg" width="454" height="53">
<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
font-family:宋体'>以<span lang=EN-US>j=4时，求解<i style='mso-bidi-font-style:normal'>next</i>[4]为例计算过程如下：<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
font-family:宋体'>根据公式<span lang=EN-US>f-4， 0&lt;<i style='mso-bidi-font-style:
normal'>k</i>&lt;4<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
font-family:宋体'>当<span lang=EN-US>k=1时， <i style='mso-bidi-font-style:normal'>t</i><sub>0</sub>=<i
style='mso-bidi-font-style:normal'>t</i><sub>3</sub>=</span></span><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>&quot;</span></i><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'>a</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体'>&quot;</span></i><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>;<span style='mso-spacerun:yes'>&nbsp; </span>（满足）<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
font-family:宋体'>当<span lang=EN-US>k=2时，<i style='mso-bidi-font-style:normal'>t</i><sub>0</sub><i
style='mso-bidi-font-style:normal'>t</i><sub>1</sub>=<i style='mso-bidi-font-style:
normal'> </i></span></span><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>&quot;</span></i><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>ab</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>&quot;</span></i><i style='mso-bidi-font-style:
normal'><span style='font-size:10.5pt;font-family:宋体'>≠<span lang=EN-US>t</span></span></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>2</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>t</span></i><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>3</span></sub><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>=</span></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>&quot;</span></i><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'>ca</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体'>&quot;</span></i><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>;<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>（不满足）<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
font-family:宋体'>当<span lang=EN-US>k=3时，<i style='mso-bidi-font-style:normal'>t</i><sub>0</sub><i
style='mso-bidi-font-style:normal'>t</i><sub>1</sub><i style='mso-bidi-font-style:
normal'>t</i><sub>2</sub><i style='mso-bidi-font-style:normal'>= </i></span></span><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>&quot;</span></i><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'>abc</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体'>&quot;</span></i><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'> ≠t</span></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>t</span></i><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>2</span></sub><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>t</span></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>3</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>=</span></i><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>&quot;</span></i><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>bca</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>&quot;</span></i><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'>;<span style='mso-spacerun:yes'>&nbsp;
</span>（不满足）<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
font-family:宋体'>因为满足条件的<span lang=EN-US>k的最大值为1，故<i style='mso-bidi-font-style:
normal'>next</i>[4]=1。<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.1pt'><b><span style='font-size:10.5pt;
font-family:宋体'>例<span lang=EN-US>2 </span></span></b><span style='font-size:
10.5pt;font-family:宋体'>模式串</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>&quot;abaabcac&quot;</span><span
style='font-size:10.5pt;font-family:宋体'>的<span lang=EN-US>next函数值如下：<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体;color:red'><o:p>&nbsp;<img src="kmp.files/f-6.jpg" width="592" height="56"></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>在求得模式的<span lang=EN-US>next函数之后，匹配可如下进行：假设以指针<i
style='mso-bidi-font-style:normal'>i</i>和<i style='mso-bidi-font-style:normal'>j</i>分别指示<span
class=GramE>主串和</span>模式中正待比较的字符，令<i style='mso-bidi-font-style:normal'>i</i>的初始值为<i
style='mso-bidi-font-style:normal'>pos</i>，<i style='mso-bidi-font-style:normal'>j</i>的初值皆为0。若在匹配过程中<i
style='mso-bidi-font-style:normal'>s</i></span></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>i</span></sub></i><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>=<i
style='mso-bidi-font-style:normal'>p</i></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><span
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>则<i
style='mso-bidi-font-style:normal'><span lang=EN-US>i</span></i>和<i
style='mso-bidi-font-style:normal'><span lang=EN-US>j</span></i>分别增<span
lang=EN-US>1，否则，<i style='mso-bidi-font-style:normal'>i</i>不变，而<i
style='mso-bidi-font-style:normal'>j</i>退到next[<i style='mso-bidi-font-style:
normal'>j</i>] 的位置再比较，若相等，则指针各自增1，否则<i style='mso-bidi-font-style:normal'>j</i>再退到下一个next值的位置，依次类推，直至下列两种可能：一种是<i
style='mso-bidi-font-style:normal'>j</i>退到某个next值(next[next[…next[<i
style='mso-bidi-font-style:normal'>j</i>]]])时字符比较相等，则指针各自增1继续进行匹配；令一种是<i
style='mso-bidi-font-style:normal'>j</i>退到值为-1（即模式的第一个字符“失配”），则此时需<span
class=GramE>将模式</span>继续向右滑动一个位置，即<span class=GramE>从主串的</span>下一个字符<i
style='mso-bidi-font-style:normal'>s</i></span></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>i</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>+1</span></sub><span
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>起和模式重新开始匹配。<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>KMP算法如算法f-1所示，它在形式上和算法4.10极为相似。<o:p></o:p><br>
  </span><span class=GramE><span
lang=EN-US style='font-size:9.0pt;mso-hansi-font-family:宋体'>int<span
style='mso-spacerun:yes'>&nbsp; </span>StrIndex</span></span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'>_KMP(SString s,int pos, SString 
  t) <o:p><br>
  </o:p></span><span lang=EN-US style='font-size:9.0pt;font-family:宋体'>/*求<span
class=GramE>从主串</span>s的下标pos起，串t第一次出现的位置*/<o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'>{<o:p></o:p><br>
  </span><span class=GramE><span
lang=EN-US style='font-size:9.0pt;mso-hansi-font-family:宋体'>int</span></span><span
lang=EN-US style='font-size:9.0pt;mso-hansi-font-family:宋体'> i, j;<o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'>if (t.len==0)<span
style='mso-spacerun:yes'>&nbsp; </span>return(0);<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>/* 空串是任意字符串<span
class=GramE>的子串</span> */<o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'>i=pos<span class=GramE>;<span
style='mso-spacerun:yes'>&nbsp; </span>j</span>=0;<o:p></o:p><br>
  </span><span class=GramE><span
lang=EN-US style='font-size:9.0pt;mso-hansi-font-family:宋体'>while</span></span><span
lang=EN-US style='font-size:9.0pt;mso-hansi-font-family:宋体'> (i&lt;s.len &amp;&amp; 
  j&lt;t.len)<o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'>if (j==-1 || s.ch[i]==t.ch[j])<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/* <span
class=GramE>主串与子串</span>的对应字符相等，则继续比较下一字符 */<o:p></o:p><br>
  <span style="font-family: 宋体">　　</span> </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体'>{<span
class=GramE>i</span>++;<span style='mso-spacerun:yes'>&nbsp; </span>j++;} <o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'>else <span style='background:#D9D9D9;
mso-shading:white;mso-pattern:gray-15 auto'>j=next[j]</span>;<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  </span>/* 发现失配字符则用next函数值更新j值，而i值不变 */<o:p></o:p><br>
  　　if (j&gt;=t.len)<span
style='mso-spacerun:yes'>&nbsp; </span>return(i-j);<span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span>/* 成功则<span class=GramE>返回主串的</span>当前起始匹配位置 
  */<o:p></o:p><br>
  　　　　else<span
style='mso-spacerun:yes'>&nbsp; </span>return(-1);<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/* 
  不成功则返回-1 */<o:p></o:p><br>
  }<o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:21.1pt'><b><span
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体;color:black'>【算法<span
lang=EN-US>f.1<span style='mso-spacerun:yes'>&nbsp; </span>KMP算法】</span></span></b><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><o:p></o:p></span></p>

<p class=a><b><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt;
mso-hansi-font-family:宋体;color:black'><o:p>&nbsp;</o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>KMP算法是在已知模式串的next函数值的基础上执行的，那么，如何求得模式串的next<span
class=GramE>函数值呢</span>？<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>由定义得知<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>next[</span>0]=-1 <span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;</span>(f-5)<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>设<span lang=EN-US>next[<i
style='mso-bidi-font-style:normal'>j</i>]=<i style='mso-bidi-font-style:normal'>k</i>,这表明在模式串中<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><i style='mso-bidi-font-style:normal'>p</i></span><sub><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'>0</span></sub><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体'>p</span></i><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>1</span></sub><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>…p</span></i><i
style='mso-bidi-font-style:normal'><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>k</span></sub></i><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>-1</span></sub><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'> =<i style='mso-bidi-font-style:normal'>
p</i></span><i style='mso-bidi-font-style:normal'><sub><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'>j-k</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j-k+1</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'> </span></i><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>(f-6)<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>其中<span lang=EN-US>k为满足0＜k＜j的某个值，并且不可能存在<i
style='mso-bidi-font-style:normal'>k'</i>＞<i style='mso-bidi-font-style:normal'>k</i>满足等式（f-6）。此时next[<i
style='mso-bidi-font-style:normal'>j</i>+1]的<span class=GramE>值可能</span>有两种情况：<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:0cm;mso-char-indent-count:0'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>(1)
若<i style='mso-bidi-font-style:normal'>p</i></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>k</span></sub></i><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>=<i
style='mso-bidi-font-style:normal'>p</i></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>,则表明在模式串中<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i
style='mso-bidi-font-style:normal'><span
style='mso-spacerun:yes'>&nbsp;</span>p</i></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>0</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>…<span class=GramE>p<sub><span
style='mso-bidi-font-size:10.5pt'>k </span></sub><span style='font-style:normal'><span
style='mso-spacerun:yes'>&nbsp;</span>=</span></span></span></i><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'> <i
style='mso-bidi-font-style:normal'>p</i></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j-k</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'> j</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'><span style='mso-spacerun:yes'>&nbsp;
</span></span></i><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
12.0pt;font-family:宋体'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>(f-7)</span><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'><o:p></o:p></span></sub></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>并且不可能存在<i style='mso-bidi-font-style:
normal'><span lang=EN-US>k<span class=GramE>’</span></span></i>＞<i
style='mso-bidi-font-style:normal'><span lang=EN-US>k</span></i>满足等式（<span
lang=EN-US>f-7），这就是说next[<i style='mso-bidi-font-style:normal'>j</i>+1]=<i
style='mso-bidi-font-style:normal'> k</i>+1，即<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE><i style='mso-bidi-font-style:normal'>next[</i></span><i
style='mso-bidi-font-style:normal'>j+1] </i>=<i style='mso-bidi-font-style:
normal'> next[j]+1</i><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>(f-8)<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm;mso-char-indent-count:0'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>(2)
若<i style='mso-bidi-font-style:normal'>p</i></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>k</span></sub></i><i
style='mso-bidi-font-style:normal'><span style='font-size:10.5pt;mso-bidi-font-size:
12.0pt;font-family:宋体'>≠<span lang=EN-US>p</span></span></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>,则表明在模式串中<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i
style='mso-bidi-font-style:normal'><span
style='mso-spacerun:yes'>&nbsp;</span>p</i></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>0</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>k</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'> ≠ p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j-k</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'> j</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'><span style='mso-spacerun:yes'>&nbsp;
</span><o:p></o:p></span></i></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>此时<span class=GramE>可把求</span><span
lang=EN-US>next函数值的问题看成是一个模式匹配的问题，整个模式串<span class=GramE>既是主串又是</span>模式串，而当前在匹配的过程中，已有<i
style='mso-bidi-font-style:normal'>p</i></span></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j-k</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>= p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>0</span></sub></i><span
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>，<i
style='mso-bidi-font-style:normal'><span lang=EN-US>p</span></i></span><i
style='mso-bidi-font-style:normal'><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>j-k+</span></sub></i><sub><span lang=EN-US style='font-size:
10.5pt;font-family:宋体'>1</span></sub><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>= p</span></i><i
style='mso-bidi-font-style:normal'><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>1</span></sub></i><span style='font-size:10.5pt;mso-bidi-font-size:
12.0pt;font-family:宋体'>，<span lang=EN-US>…，<i style='mso-bidi-font-style:normal'>p</i></span></span><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>j-1</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>= p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>k</span></sub></i><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>-1</span></sub><span
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>，则当<i
style='mso-bidi-font-style:normal'><span lang=EN-US>p</span></i></span><i
style='mso-bidi-font-style:normal'><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>j</span></sub></i><span style='font-size:10.5pt;mso-bidi-font-size:
12.0pt;font-family:宋体'>≠<i style='mso-bidi-font-style:normal'><span lang=EN-US>p</span></i></span><i
style='mso-bidi-font-style:normal'><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>k</span></sub></i><span style='font-size:10.5pt;mso-bidi-font-size:
12.0pt;font-family:宋体'>时应<span class=GramE>将模式</span>向右滑动至<span class=GramE>以模式</span>中的第<span
lang=EN-US>next[<i style='mso-bidi-font-style:normal'>k</i>]<span class=GramE>个</span>字符和<span
class=GramE>主串中</span>的第<i style='mso-bidi-font-style:normal'>j</i><span
class=GramE>个</span>字符相比较。若next[<i style='mso-bidi-font-style:normal'>k</i>]=<i
style='mso-bidi-font-style:normal'>k<span class=GramE>’</span></i>，且<i
style='mso-bidi-font-style:normal'>p</i></span></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>=<i
style='mso-bidi-font-style:normal'>p</i></span><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>k<span
class=GramE>’</span></span></sub></i><span style='font-size:10.5pt;mso-bidi-font-size:
12.0pt;font-family:宋体'>，则说明在<span class=GramE>主串中</span>第<i style='mso-bidi-font-style:
normal'><span lang=EN-US>j</span></i><span lang=EN-US>+1个字符之前存在一个长度为<i
style='mso-bidi-font-style:normal'>k'</i>（即next[<i style='mso-bidi-font-style:
normal'>k</i>]）的<span class=GramE>最</span>长子串，和<span class=GramE>模式串中从</span>首字符起长度为<i
style='mso-bidi-font-style:normal'>k</i><span class=GramE>的子串相等</span>，即<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><i style='mso-bidi-font-style:normal'>p</i></span><sub><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'>0</span></sub><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;
font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:normal'><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>k’ </span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>= p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j-k’</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>…p</span></i><i style='mso-bidi-font-style:
normal'><sub><span lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'> </span></i><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;</span>（0＜<i style='mso-bidi-font-style:
normal'>k'</i>＜<i style='mso-bidi-font-style:normal'>k</i>＜<i style='mso-bidi-font-style:
normal'>j</i>）<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>（f-9）<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>这就是说<span lang=EN-US>next[<i
style='mso-bidi-font-style:normal'>j</i>+1]=<i style='mso-bidi-font-style:normal'>k<span
class=GramE>’</span></i>+1即<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='mso-spacerun:yes'>&nbsp;</span><span class=GramE>next[</span><i
style='mso-bidi-font-style:normal'>j</i>+1]=next[<i style='mso-bidi-font-style:
normal'>k</i>]+1<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>(f-10)<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>同理，若<i style='mso-bidi-font-style:
normal'><span lang=EN-US>p</span></i></span><i style='mso-bidi-font-style:normal'><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub></i><span
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>≠<i
style='mso-bidi-font-style:normal'><span lang=EN-US>p</span></i></span><i
style='mso-bidi-font-style:normal'><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>k<span class=GramE>’</span></span></sub></i><span lang=EN-US
style='font-size:10.5pt;font-family:宋体'>,则<span class=GramE>将模式</span>继续向右滑动直至<span
class=GramE>将模式</span>中第next[<i style='mso-bidi-font-style:normal'>k'</i>]<span
class=GramE>个</span>字符和</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>p</span></i><i
style='mso-bidi-font-style:normal'><sub><span lang=EN-US style='font-size:10.5pt;
font-family:宋体'>j</span></sub></i><span style='font-size:10.5pt;font-family:
宋体'>对齐，<span lang=EN-US>……,依次类推，直至</span></span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>p</span><sub><span
lang=EN-US style='font-size:10.5pt;font-family:宋体'>j</span></sub><span
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'>和模式中某个字符匹配成功或者不存在任何<i
style='mso-bidi-font-style:normal'><span lang=EN-US>k'</span></i><span
lang=EN-US>(0&lt;<i style='mso-bidi-font-style:normal'>k'</i>&lt;<i
style='mso-bidi-font-style:normal'>j</i>)满足等式（f-9），则<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:12.0pt;font-family:宋体'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;</span><span class=GramE>next[</span><i
style='mso-bidi-font-style:normal'>j</i>+1]=0 <i style='mso-bidi-font-style:
normal'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></i><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>(f-11)<o:p></o:p></span></p>

<p class=MsoNormalIndent><span class=GramE><span style='font-family:宋体'>见例</span></span><span
lang=EN-US style='font-family:宋体'>2的next表，已求得前6个字符的next函数值，<span class=GramE>现求</span>next[6],因为next[5]=2,又p</span><sub><span
lang=EN-US style='mso-bidi-font-size:10.5pt;font-family:宋体'>5</span></sub><span
style='font-family:宋体'>≠<span lang=EN-US>p</span></span><sub><span lang=EN-US
style='mso-bidi-font-size:10.5pt;font-family:宋体'>2</span></sub><span
style='mso-bidi-font-size:10.5pt;font-family:宋体'>，则<span class=GramE>需比较</span></span><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-family:宋体'>p</span></i><sub><span
lang=EN-US style='mso-bidi-font-size:10.5pt;font-family:宋体'>5</span></sub><span
style='font-family:宋体'>和<i style='mso-bidi-font-style:normal'><span lang=EN-US>p</span></i></span><sub><span
lang=EN-US style='mso-bidi-font-size:10.5pt;font-family:宋体'>0</span></sub><span
style='mso-bidi-font-size:10.5pt;font-family:宋体'>（因为<span lang=EN-US>next[<i
style='mso-bidi-font-style:normal'>2</i>]=0），这相当于将<span class=GramE>子串模式</span>向右滑动。由于</span></span><span
lang=EN-US style='font-family:宋体'>p</span><sub><span lang=EN-US
style='mso-bidi-font-size:10.5pt;font-family:宋体'>5</span></sub><span
style='font-family:宋体'>≠<span lang=EN-US>p</span></span><sub><span lang=EN-US
style='mso-bidi-font-size:10.5pt;font-family:宋体'>0</span></sub><span
style='mso-bidi-font-size:10.5pt;font-family:宋体'>，且<span lang=EN-US>next[0]=-1，所以next[6]=0，而因为</span></span><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-family:宋体'>p</span></i><sub><span
lang=EN-US style='mso-bidi-font-size:10.5pt;font-family:宋体'>6</span></sub><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-family:宋体'>=p</span></i><sub><span
lang=EN-US style='mso-bidi-font-size:10.5pt;font-family:宋体'>0</span></sub><span
style='mso-bidi-font-size:10.5pt;font-family:宋体'>，则<span lang=EN-US>next[7]=1。<o:p></o:p></span></span></p>

<p class=MsoNormalIndent style='text-indent:22.5pt'><span style='font-family:
宋体'>根据以上分析所得结果<span class=GramE>（</span>式<span lang=EN-US>(f-5)、<span
class=GramE>（</span>f-8<span class=GramE>）</span>、（f-10）和（f-11）<span
class=GramE>）</span>，仿照KMP算法，可得到求next函数值的算法，如下所示：<o:p></o:p><br>
  </span></span><span class=GramE><span
lang=EN-US style='font-size:9.0pt;mso-hansi-font-family:宋体'>void</span></span><span
lang=EN-US style='font-size:9.0pt;mso-hansi-font-family:宋体'> Get_nextpos(SString 
  t, int next[])<o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'>/*<span class=GramE>求模式串</span>t的next函数修正值并存入数组next[]中*/<o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'>{<span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>int</span> i,j;<o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>i=0; j=-1; <span class=GramE>next[</span>0]=-1;<o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>while(</span>i&lt;t.len) <o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>{<span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; 
  </span><span
class=GramE>if(</span>j==-1 || t.ch[i]==t.ch[j]) <o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>i</span>++;<span
style='mso-tab-count:1'> </span>j++;<o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'><span style='mso-tab-count:
3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if</span> (t.ch[i]!=t.ch[j]) <span style='mso-tab-count:1'> </span>next[i]=j;<o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'><span style='mso-tab-count:
3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>else <span style='mso-spacerun:yes'>&nbsp;</span>next</span>[i]=next[j];<o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=GramE>else <span style='mso-spacerun:yes'>&nbsp;</span>j</span>=next[j];<o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p><br>
  </span><span lang=EN-US
style='font-size:9.0pt;mso-hansi-font-family:宋体'>}<o:p></o:p></span></p>

<p class=a><b><span style='font-size:10.5pt;mso-bidi-font-size:10.0pt;
mso-hansi-font-family:宋体;color:black'>【算法<span lang=EN-US>f.2<span
style='mso-spacerun:yes'>&nbsp; </span>求next函数值算法】<o:p></o:p></span></span></b></p>

<p class=a><b><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt;
mso-hansi-font-family:宋体;color:red'><o:p>&nbsp;</o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:12.0pt;font-family:宋体'>算法<span lang=EN-US>f.2的时间复杂度为O(m)。通常模式串的长度m<span
class=GramE>比主串</span>的长度n要小得多，因此，对整个匹配算法来说，所增加的这点时间是值得的。</span></span></p>

<p class=MsoNormal style='text-indent:24.0pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

</body>

</html>
